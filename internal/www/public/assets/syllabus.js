import{f as k,r as d,s as w,g as S,o as u,c,a as v,H as T,h as e,t as i,u as s,b as _,i as N,w as y,n as f,k as $,F as D,e as x}from"./Header.js";const C={class:"container p-3"},E={id:"msg",class:"msg"},I={key:0,id:"syllabus"},V={class:"syllabus"},q=e("h2",null,"Attachments",-1),A=["href"],B={class:"request-link"},F=e("p",null,[e("b",null,"Is this your syllabus?")],-1),O=e("p",null," Enter the email address that you used in order to receive an edit link. ",-1),P={action:"/api/magic-link",method:"POST",id:"request-email"},H=["disabled"],L={class:"log"},U=k({setup(j){const g="",r=d(""),l=d(""),m=d("Loading cartridge..."),h=d(!1),n=w({id:"",title:"",description:"",attachments:new Array});let b=()=>{const o=document.getElementById("request-email"),t=new FormData(o);!n||!n.id||(l.value=`Sending email to: ${r.value}`,h.value=!0,fetch("/api/magic-link",{body:t,method:"POST"}).then(a=>{a.ok?l.value=`Sent email to: ${r.value}. Check your inbox!`:l.value="The email entered doesn't match the one on record. Please check and try again."}).catch(a=>{l.value="There was an error verifying your email.",console.error(a)}).finally(()=>{h.value=!1}))};return S(()=>{let o=parseInt(window.location.pathname.split("/")[2]);if(isNaN(o)){console.error("URL parameter is not a number:",o);return}fetch(`${g}/syllabi/${o}`,{headers:{"Content-Type":"application/json"}}).then(t=>{if(t.status==200)return t.json();throw new Error(`error: ${t.status} ${t.statusText}`)}).then(t=>{let a=JSON.parse(t);l.value="",m.value="",n.id=a.ID,n.title=a.title,n.description=a.description;for(let p of a.Attachments)n.attachments.push({id:p.ID,name:p.Name})}).catch(t=>{console.log(t.message),m.value="Sorry! There was an error getting the cartridge information. Please try again later."})}),(o,t)=>(u(),c(_,null,[v(T),e("main",null,[e("div",C,[e("div",E,i(m.value),1),s(n).title!=""?(u(),c("div",I,[e("div",V,[e("h1",null,i(s(n).title),1),e("p",null,i(s(n).description),1),q,e("div",null,[e("ol",null,[(u(!0),c(_,null,N(s(n).attachments,a=>(u(),c("li",null,[e("a",{href:"/attachments/"+a.id+"?type=file",target:"_blank"},i(a.name),9,A)]))),256))])])]),e("div",B,[F,O,e("form",P,[y(e("input",{name:"email",type:"email","onUpdate:modelValue":t[0]||(t[0]=a=>r.value=a),autocomplete:"email"},null,512),[[f,r.value]]),y(e("input",{type:"number",name:"id","onUpdate:modelValue":t[1]||(t[1]=a=>s(n).id=a),hidden:""},null,512),[[f,s(n).id]]),e("button",{onClick:t[2]||(t[2]=a=>s(b)()),type:"button",class:"btn cc-btn",disabled:h.value}," Request ",8,H)]),e("div",L,i(l.value),1)])])):$("",!0)])]),v(D)],64))}});x(U).mount("#app");
